# Platform Details | Mac

(This document is from the FMOD Engine User Manual 2.02.22 (2024-05-05). Â© 2024 Firelight Technologies Pty Ltd.)
<!-- This markdown is generated by docgen. Do not edit by hand. -->

## macOS Specific Starter Guide

### SDK Version

FMOD is compiled using the following tools.

- **Xcode** - version 15.0.1 targeting macOS 14.0.

### Compatibility

FMOD supports x86_64 and arm64 back to macOS 10.13. Please note that both x86 and PPC are not accepted for submission to the Mac App Store and thus are no longer supported by FMOD.

### Libraries

#### FMOD Core Engine library

- **/api/core/lib/libfmod.dylib** - Release binary for production code.
- **/api/core/lib/libfmodL.dylib** - Release binary with logging enabled for development.


<pre class="ignore" style="white-space:normal;font:inherit;">
FMOD.rs searches <code>$CARGO_MANIFEST_DIR/lib/$CARGO_CFG_TARGET_ARCH/</code>
using Cargo standard search path manipulation for <code>fmodL.dylib</code> or
<code>fmod.dylib</code> depending on whether <code>cfg(debug_assertions)</code>
is true or false, respectively.
</pre>

#### FMOD Studio Engine library (used in conjunction with core library)

- **/api/studio/lib/libfmodstudio.dylib** - Release binary for production code.
- **/api/studio/lib/libfmodstudioL.dylib** - Release binary with logging enabled for development.


<pre class="ignore" style="white-space:normal;font:inherit;">
FMOD.rs searches <code>$CARGO_MANIFEST_DIR/lib/$CARGO_CFG_TARGET_ARCH/</code>
using Cargo standard search path manipulation for <code>fmodstudioL.dylib</code>
or <code>fmodstudio.dylib</code> depending on whether
<code>cfg(debug_assertions)</code> is true or false, respectively.
</pre>

### Latency

The default latency introduced by FMOD for this platform is 4 blocks of 512 samples at a sample rate of 48 kHz, which equates to approximately 43 ms. You are free to change this using two APIs, [`System::set_dsp_buffer_size`](System::set_dsp_buffer_size) and [`System::set_software_format`](System::set_software_format) but there are some important considerations.

All audio devices have a number of samples they prefer to operate in, on Mac this is almost always 512, which makes our default a natural fit. If you use [`System::set_dsp_buffer_size`](System::set_dsp_buffer_size) to reduce FMODs granularity (to 256 samples for instance), be aware the audio device will still operate at its native block of 512 samples. If you would like to reduce the block size of the audio device (to 256 samples), after you have set the FMOD granularity and initialized the System object use the following code:


```rust,ignore
let audio_unit = system.get_output_handle() as *mut AudioUnit;

let mut audio_device_id: AudioDeviceID = mem::zeroed();
let mut audio_device_id_size = mem::size_of::<AudioDeviceID>();
AudioToolbox::AudioUnitGetProperty(
    audio_unit,
    kAudioOutputUnitProperty_CurrentDevice,
    kAudioUnitScope_Global,
    0,
    &mut audio_device_id,
    &mut audio_device_id_size,
);

let mut bufer_frame_size: u32 = 256;
CoreAudio::AudioDeviceSetProperty(
    audio_device_id,
    ptr::null(),
    0,
    false,
    kAudioDevicePropertyBufferFrameSize,
    mem::size_of::<u32>(),
    &mut buffer_frame_size,
);
```

<pre class="ignore" style="white-space:normal;font:inherit;">
<a href="https://developer.apple.com/documentation/coreaudio/1580742-audiodevicesetproperty?language=objc"><code>AudioDeviceSetProperty</code></a>
was deprecated in macOS 10.6 (2009, Snow Leopard) and never exposed to Swift.
This is probably a bad idea. Using <a href="https://developer.apple.com/documentation/audiotoolbox/1440371-audiounitsetproperty/"><code>AudioUnitSetProperty</code></a>
or <a href="https://developer.apple.com/documentation/avfaudio/avaudiosession/1616589-setpreferrediobufferduration"><code>setPreferredIOBufferDuration</code></a>
may be preferable.
</pre>


### Thread Affinity

All threads will default to [`ThreadAffinity::CoreAll`](ThreadAffinity::CoreAll), it is not currently possible to override this with [`thread::set_attributes`](thread::set_attributes).

### Thread Priority

The relationship between FMOD platform agnostic thread priority and the platform specific values is as follows:

- [`ThreadPriority::Low`](ThreadPriority::Low) ~ 83
- [`ThreadPriority::Medium`](ThreadPriority::Medium) ~ 87
- [`ThreadPriority::High`](ThreadPriority::High) ~ 90
- [`ThreadPriority::VeryHigh`](ThreadPriority::VeryHigh) ~ 94
- [`ThreadPriority::Extreme`](ThreadPriority::Extreme) ~ 97
- [`ThreadPriority::Critical`](ThreadPriority::Critical) ~ 99

## Performance Reference

This section is a companion for the [CPU Performance](<https://fmod.com/docs/2.02/api/white-papers-cpu-performance.html>) white paper and serves as a quick reference of facts targeting this platform.

### Format Choice

Each compression format provided in FMOD has a reason for being included, the below list will detail our recommendations for this platform. Formats listed as primary are considering the best choice, secondary formats should only be considered if the primary doesn't satisfy your requirements.

- **Vorbis**: Primary format for all sounds.
- **FADPCM**: Secondary format if Vorbis CPU usage is too high for low spec machines.
- **PCM**: Not recommended.
- **XMA**: Unavailable.
- **AT9**: Unavailable.

### Channel Count

To give developers an idea about the costs of a particular format we provide synthetic benchmark results. These results are based on simple usage of the FMOD Studio API using recommended configuration settings.

#### Settings

- **Real channel count:** 64
- **Sample rate:** 48 kHz
- **Speaker mode:** Stereo
- **DSP block size:** 512 samples

#### Test Device

- **CPU:** Intel(R) Core(TM) i5-4278U CPU @ 2.60GHz
- **OS:** macOS 10.15.7 (19H2)

#### Results

- **DSP with Vorbis:** 7.78% (+/- 0.95%)
- **DSP with FADPCM:** 4.90% (+/- 0.61%)
- **DSP with PCM:** 2.93% (+/- 0.58%)
- **Update at 60 FPS:** 1.81% (+/- 0.35%)

